<!doctype html>
<html>
<head>
<meta charset="utf-8">
<link rel="stylesheet" href="index.css">
<title>Wave Generator</title>
</head>

<body>

<div class="ğŸ“–">
	<div class="ğŸ´">æ•°æ®æ¥æº</div>
	<div class="ğŸ">
		<input name="tab" type="radio" id="tab2" checked="checked">
		<label for="tab2"><div class="â• â•t">ç”Ÿæˆæ–¹æ³• 1 - Bytebeat</div></label>
		<div class="ğŸ“‘">
			<div class="â•">ä½¿ç”¨æ•°å­¦å…¬å¼ç”Ÿæˆæ³¢å½¢æ•°æ® (è‡ªå˜é‡ - t)</div>
			<div class="â•">é¢„ç½®<select id="ğŸ“">
				<option value="">&nbsp;</option>
				<optgroup label="8 kHz" id="ğŸ¶8"></optgroup>
				<optgroup label="11 kHz" id="ğŸ¶11"></optgroup>
				<optgroup label="22 kHz" id="ğŸ¶22"></optgroup>
				<optgroup label="32 kHz" id="ğŸ¶32"></optgroup>
				<optgroup label="44 kHz" id="ğŸ¶44"></optgroup>
			</select></div>
			<div class="â•">
			é‡‡æ ·ç‡(Hz)<input type="number" pattern="[0-9]*" id="ğŸ”¢2_0" min="1000" step="100" value="8000">&nbsp;&nbsp;|
			é•¿åº¦(ç§’)<input type="number" pattern="[0-9]*" id="ğŸ”¢2_1" min="1" step="1" value="30">&nbsp;&nbsp;|
			éŸ³è´¨<input type="number" pattern="[0-9]*" id="ğŸ”¢2_2" min="1" step="1" value="6">
			</div>
			<div class="â•"><textarea id="ğŸ“">t*(42&t>>10)</textarea>
			<div id="ğŸ›‘" style="display: none;"></div></div>
			<div class="â•"><label id="ğŸ§®">ç¼–è¯‘</label></div>
		</div>
	</div>
	<div class="ğŸ">
		<hr>
		<input name="tab" id="tab1" type="radio">
		<label for="tab1"><div class="â• â•t">ç”Ÿæˆæ–¹æ³• 2 - æ–‡ä»¶è½¬æ¢</div></label>
		<div class="ğŸ“‘">
			<div class="â•">ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œè¡¥å…… Wave æ–‡ä»¶å¤´ï¼Œä»¤æ–‡ä»¶æ•°æ®ä½œä¸ºåŸç”Ÿæ³¢å½¢æ•°æ®è¯»å–</div>
			<div class="â•">ç»å¤§å¤šæ•°æ–‡ä»¶å¯èƒ½ä¼šæ˜¯å™ªéŸ³ï¼Œä½†ä½ æ‰€å¬åˆ°çš„ç»å¯¹æ˜¯æ–‡ä»¶åŸç¼–ç ~</div>
			<div class="â•">ç ç‡(Hz)<input type="number" pattern="[0-9]*" id="ğŸ”¢" min="1000" step="100" value="48000"></div>
			<div class="â•"><label for="ğŸ“‚">ä¸Šä¼ æ–‡ä»¶</label></div>
			<input type="file" id="ğŸ“‚">
		</div>
	</div>
</div>

<div class="ğŸ“– ğŸ“—">
	<div class="ğŸ´">ç”Ÿæˆç»“æœ</div>
	<div class="ğŸ">
		<div class="â• â•p"><label><input type="checkbox" id="â–¶" checked="checked">è‡ªåŠ¨æ’­æ”¾</label></div>
		<div class="â•"><audio id="ğŸ¼" controls="controls" ></audio></div>
		<div class="â•"><a id="ğŸ’¾">ä¸‹è½½éŸ³é¢‘</a></div>
	</div>
</div>

<div style="height: 20px;"></div>

<script src="data2wave.js" language="javascript"></script>
<script src="bytebeat_examples.js" language="javascript"></script>
<script language="javascript">
var read = new FileReader();
read.onload = function(){
	var src = data2wave(Number(document.getElementById("ğŸ”¢").value) || 48000, this.result);
	document.getElementById("ğŸ¼").src = src;
	window.scrollTo(0, document.documentElement.clientHeight);
	if(document.getElementById("â–¶").checked) document.getElementById("ğŸ¼").play();
	document.getElementById("ğŸ’¾").href = src;
	document.getElementById("ğŸ’¾").download = new Date().getTime() + ".wav";
}
document.getElementById("ğŸ“‚").onchange = function(){
	read.readAsBinaryString(this.files[0]);
	this.value = "";
}
document.getElementById("ğŸ“").onfocus = function(){
	document.getElementById("ğŸ›‘").style.display = "none";
}
document.getElementById("ğŸ§®").onclick = function(){
	var f = document.getElementById("ğŸ“").value,
		r = Number(document.getElementById("ğŸ”¢2_0").value) || 8000,
		d = Number(document.getElementById("ğŸ”¢2_1").value) || 30,
		q = Number(document.getElementById("ğŸ”¢2_2").value) || 6,
		data = new Array();
	for(let i = 0; i < r * d; i++){
		try{
			let t = i;
			let p = eval(f);
			for(let c = 0; c < q; c++) data.push(p);
		}
		catch(e){
			document.getElementById("ğŸ›‘").innerHTML = e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\n/g,"<br>");
			document.getElementById("ğŸ›‘").style.display = "block";
			return false;
		}
	}
	var src = data2wave(r * q, data);
	document.getElementById("ğŸ¼").src = src;
	window.scrollTo(document.querySelector(".ğŸ“—").offsetLeft, document.querySelector(".ğŸ“—").offsetTop);
	if(document.getElementById("â–¶").checked) document.getElementById("ğŸ¼").play();
	document.getElementById("ğŸ’¾").href = src;
	document.getElementById("ğŸ’¾").download = new Date().getTime() + ".wav";
}
document.getElementById("ğŸ“").onchange = document.getElementById("ğŸ”¢2_0").onchange = document.getElementById("ğŸ”¢2_2").onchange = function(){
	document.getElementById("ğŸ“").value = "";
}
bytebeat_examples.forEach(function(e, i){
	var opt = document.createElement("option");
	opt.value = i;
	opt.innerHTML = e.title.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");
	document.getElementById("ğŸ¶" + e.khz).appendChild(opt);
});
document.getElementById("ğŸ“").onchange = function(){
	if(this.value != ""){
		document.getElementById("ğŸ›‘").style.display = "none";
		var it = bytebeat_examples[this.value];
		document.getElementById("ğŸ“").value = it.value;
		document.getElementById("ğŸ”¢2_0").value = it.khz * 1000;
		document.getElementById("ğŸ”¢2_2").value = it.quality;
	}
}
</script>
</body>
</html>
